<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Matt Lilley</title>
    <meta name="author" content="Matt Lilley" />
    <meta
      name="description"
      content="An interactive digital experiment to create rainbows inside a computer"
    />
    <meta
      name="keywords"
      content="science,technology,physics,rainbows,simulation,code"
    />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:image"
      content="https://mattlilley.com/lets-make-rainbows/rainbow.jpg"
    />
    <meta name="twitter:title" content="Let's make rainbows" />
    <meta
      name="twitter:description"
      content="An interactive digital experiment to create rainbows inside a computer"
    />

    <meta name="twitter:site" content="@mklilley" />
    <meta property="og:title" content="Let's make rainbows" />
    <meta
      property="og:description"
      content="An interactive digital experiment to create rainbows inside a computer"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://mattlilley.com/lets-make-rainbows"
    />
    <meta
      property="og:image"
      content="https://mattlilley.com/lets-make-rainbows/rainbow.jpg"
    />
    <meta property="og:site_name" content="Matt Lilley" />

    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css" />

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"
      integrity="sha512-DWtDo/6AXxH1t9p7GCWqmC4XTVK/eje94XTV6QYB39rGllLN8Tr3izDf6lkmebgqRnYh4wtSFm4CvBoA9SrdpA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      defer
    ></script>

    <script src="./js/globalState.js" defer></script>
    <script src="./js/photons.js" defer></script>
    <script src="./js/prism.js" defer></script>
    <script src="./js/ui.js" defer></script>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
        width: 100%;
        user-select: none;
      }

      body > * {
        grid-column: 2;
        grid-row: 1;
      }

      h1,
      h2,
      h3,
      h4 {
        margin: 0;
      }

      h1,
      h2 {
        text-align: center;
      }

      :root {
        --accent: rgba(230, 0, 0);
      }

      #menu details {
        background-color: rgba(245, 247, 255, 0.98);
      }

      input[type="range"] {
        accent-color: var(--accent);
      }

      .hidden {
        display: none;
      }

      #menu {
        position: absolute;
        z-index: 2;
        margin: 10px;
        overflow: auto;
        max-height: 100%;
      }
      #reflectivity-container {
        display: flex;
        align-items: center;
        width: 100%;
      }

      #reflectivity-container input[type="range"] {
        flex: 1;
      }

      #create-prism-controls {
        margin-left: 20px;
      }

      .gg-minimize-alt {
        box-sizing: border-box;
        position: relative;
        display: block;
        transform: rotate(-45deg) scale(var(--ggs, 1));
        width: 26px;
        height: 2px;
        border-left: 10px solid;
        border-right: 10px solid;
      }

      .gg-minimize-alt::after,
      .gg-minimize-alt::before {
        content: "";
        display: block;
        box-sizing: border-box;
        position: absolute;
        width: 6px;
        height: 6px;
        border-top: 2px solid;
        top: -2px;
      }

      .gg-minimize-alt::before {
        border-right: 2px solid;
        left: -5px;
        transform: rotate(45deg);
      }

      .gg-minimize-alt::after {
        border-left: 2px solid;
        right: -5px;
        transform: rotate(-45deg);
      }

      #welcome {
        overflow: auto;
        z-index: 3;
        position: relative;
        /* width: 80vw;
        height: 200px; */
        /* border-radius: 5px; */
        background: linear-gradient(
          135deg,
          rgba(255, 0, 0, 1) 0%,
          #ffa500 20%,
          rgba(255, 255, 0, 1) 40%,
          rgba(0, 255, 0, 1) 60%,
          rgba(0, 0, 255, 1) 80%,
          rgba(128, 0, 128, 1) 100%
        );
      }

      #welcome .notice {
        background-color: rgba(245, 247, 255, 0.8);
      }

      #welcome button {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
        width: 100%;
        max-width: 400px;
        margin: auto;
        display: block;
        /* font-weight: bold; */
        color: white;
        background-color: rgba(245, 247, 255, 0.25);
        border-image: linear-gradient(
            135deg,
            rgba(128, 0, 128, 1) 0%,
            rgba(0, 0, 255, 1) 20%,
            rgba(0, 255, 0, 1) 40%,
            rgba(255, 255, 0, 1) 60%,
            #ffa500 80%,
            rgba(255, 0, 0, 1) 100%
          )
          3;
        border-width: 3px;
        border-style: solid;
      }
    </style>
  </head>
  <body>
    <main></main>

    <!-- options menu -->
    <div id="menu" class="hidden">
      <button id="hide">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M6.2253 4.81108C5.83477 4.42056 5.20161 4.42056 4.81108 4.81108C4.42056 5.20161 4.42056 5.83477 4.81108 6.2253L10.5858 12L4.81114 17.7747C4.42062 18.1652 4.42062 18.7984 4.81114 19.1889C5.20167 19.5794 5.83483 19.5794 6.22535 19.1889L12 13.4142L17.7747 19.1889C18.1652 19.5794 18.7984 19.5794 19.1889 19.1889C19.5794 18.7984 19.5794 18.1652 19.1889 17.7747L13.4142 12L19.189 6.2253C19.5795 5.83477 19.5795 5.20161 19.189 4.81108C18.7985 4.42056 18.1653 4.42056 17.7748 4.81108L12 10.5858L6.2253 4.81108Z"
            fill="currentColor"
          />
        </svg>
      </button>

      <button id="min">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M20.0735 2L21.4877 3.41421L15.6378 9.26416H18.1824V11.2642H12.1824V5.26416H14.1824V7.89111L20.0735 2Z"
            fill="currentColor"
          />
          <path
            d="M11.1824 12.2642V18.2642H9.1824V15.8422L3.41421 21.6104L2 20.1962L7.93203 14.2642H5.1824V12.2642H11.1824Z"
            fill="currentColor"
          />
        </svg>
      </button>

      <button id="max" class="hidden">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3 3H9V5H6.46173L11.3047 9.84298L9.8905 11.2572L5 6.3667V9H3V3Z"
            fill="currentColor"
          />
          <path
            d="M3 21H9V19H6.3764L11.3046 14.0718L9.89038 12.6576L5 17.548V15H3V21Z"
            fill="currentColor"
          />
          <path
            d="M15 21H21V15H19V17.5244L14.1332 12.6576L12.719 14.0718L17.6472 19H15V21Z"
            fill="currentColor"
          />
          <path
            d="M21 3H15V5H17.5619L12.7189 9.84301L14.1331 11.2572L19 6.39032V9H21V3Z"
            fill="currentColor"
          />
        </svg>
      </button>

      <button id="done" class="hidden">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10.5858 13.4142L7.75735 10.5858L6.34314 12L10.5858 16.2427L17.6568 9.1716L16.2426 7.75739L10.5858 13.4142Z"
            fill="currentColor"
          />
        </svg>
      </button>

      <span id="edit-prism-controls">
        <button id="create">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M21.2635 2.29289C20.873 1.90237 20.2398 1.90237 19.8493 2.29289L18.9769 3.16525C17.8618 2.63254 16.4857 2.82801 15.5621 3.75165L4.95549 14.3582L10.6123 20.0151L21.2189 9.4085C22.1426 8.48486 22.338 7.1088 21.8053 5.99367L22.6777 5.12132C23.0682 4.7308 23.0682 4.09763 22.6777 3.70711L21.2635 2.29289ZM16.9955 10.8035L10.6123 17.1867L7.78392 14.3582L14.1671 7.9751L16.9955 10.8035ZM18.8138 8.98525L19.8047 7.99429C20.1953 7.60376 20.1953 6.9706 19.8047 6.58007L18.3905 5.16586C18 4.77534 17.3668 4.77534 16.9763 5.16586L15.9853 6.15683L18.8138 8.98525Z"
              fill="currentColor"
            />
            <path
              d="M2 22.9502L4.12171 15.1717L9.77817 20.8289L2 22.9502Z"
              fill="currentColor"
            />
          </svg>
        </button>

        <button id="delete">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M17 5V4C17 2.89543 16.1046 2 15 2H9C7.89543 2 7 2.89543 7 4V5H4C3.44772 5 3 5.44772 3 6C3 6.55228 3.44772 7 4 7H5V18C5 19.6569 6.34315 21 8 21H16C17.6569 21 19 19.6569 19 18V7H20C20.5523 7 21 6.55228 21 6C21 5.44772 20.5523 5 20 5H17ZM15 4H9V5H15V4ZM17 7H7V18C7 18.5523 7.44772 19 8 19H16C16.5523 19 17 18.5523 17 18V7Z"
              fill="currentColor"
            />
            <path d="M9 9H11V17H9V9Z" fill="currentColor" />
            <path d="M13 9H15V17H13V9Z" fill="currentColor" />
          </svg>
        </button>
      </span>

      <span id="create-prism-controls" class="hidden">
        <button id="undo">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M5.33929 4.46777H7.33929V7.02487C8.52931 6.08978 10.0299 5.53207 11.6607 5.53207C15.5267 5.53207 18.6607 8.66608 18.6607 12.5321C18.6607 16.3981 15.5267 19.5321 11.6607 19.5321C9.51025 19.5321 7.58625 18.5623 6.30219 17.0363L7.92151 15.8515C8.83741 16.8825 10.1732 17.5321 11.6607 17.5321C14.4222 17.5321 16.6607 15.2935 16.6607 12.5321C16.6607 9.77065 14.4222 7.53207 11.6607 7.53207C10.5739 7.53207 9.56805 7.87884 8.74779 8.46777L11.3393 8.46777V10.4678H5.33929V4.46777Z"
              fill="currentColor"
            />
          </svg>
        </button>

        <button id="triangle">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M11.6603 5L3 20H20.3205L11.6603 5ZM11.6603 11L8.19615 17H15.1244L11.6603 11Z"
              fill="currentColor"
            />
          </svg>
        </button>
        <button id="square">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M17 7H7V17H17V7ZM4 4V20H20V4H4Z"
              fill="currentColor"
            />
          </svg>
        </button>
        <button id="circle">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20Z"
              fill="currentColor"
            />
          </svg>
        </button>
      </span>

      <div id="menu-max">
        <details>
          <summary>
            Create prisms

            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M21.2635 2.29289C20.873 1.90237 20.2398 1.90237 19.8493 2.29289L18.9769 3.16525C17.8618 2.63254 16.4857 2.82801 15.5621 3.75165L4.95549 14.3582L10.6123 20.0151L21.2189 9.4085C22.1426 8.48486 22.338 7.1088 21.8053 5.99367L22.6777 5.12132C23.0682 4.7308 23.0682 4.09763 22.6777 3.70711L21.2635 2.29289ZM16.9955 10.8035L10.6123 17.1867L7.78392 14.3582L14.1671 7.9751L16.9955 10.8035ZM18.8138 8.98525L19.8047 7.99429C20.1953 7.60376 20.1953 6.9706 19.8047 6.58007L18.3905 5.16586C18 4.77534 17.3668 4.77534 16.9763 5.16586L15.9853 6.15683L18.8138 8.98525Z"
                fill="currentColor"
              />
              <path
                d="M2 22.9502L4.12171 15.1717L9.77817 20.8289L2 22.9502Z"
                fill="currentColor"
              />
            </svg>
          </summary>

          <p>
            Tap to create your own shapes, or use ours. <br />
            Drag anywhere to move a completed shape. <br />
            Drag corners of a completed shape to resize and rotate. <br />
            Tap on
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10.5858 13.4142L7.75735 10.5858L6.34314 12L10.5858 16.2427L17.6568 9.1716L16.2426 7.75739L10.5858 13.4142Z"
                fill="currentColor"
              />
            </svg>
            when you're done.
          </p>
        </details>

        <details>
          <summary>
            Delete prisms
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M17 5V4C17 2.89543 16.1046 2 15 2H9C7.89543 2 7 2.89543 7 4V5H4C3.44772 5 3 5.44772 3 6C3 6.55228 3.44772 7 4 7H5V18C5 19.6569 6.34315 21 8 21H16C17.6569 21 19 19.6569 19 18V7H20C20.5523 7 21 6.55228 21 6C21 5.44772 20.5523 5 20 5H17ZM15 4H9V5H15V4ZM17 7H7V18C7 18.5523 7.44772 19 8 19H16C16.5523 19 17 18.5523 17 18V7Z"
                fill="currentColor"
              />
              <path d="M9 9H11V17H9V9Z" fill="currentColor" />
              <path d="M13 9H15V17H13V9Z" fill="currentColor" />
            </svg>
          </summary>

          <p>
            Tap on a prism to delete it. <br />
            Tap on
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10.5858 13.4142L7.75735 10.5858L6.34314 12L10.5858 16.2427L17.6568 9.1716L16.2426 7.75739L10.5858 13.4142Z"
                fill="currentColor"
              />
            </svg>
            when you're done.
          </p>
        </details>

        <details>
          <summary>Change boundary</summary>
          Boundary reflectivity
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          <br />
          <div id="reflectivity-container">
            <span>0%</span>
            <input
              id="reflectivity-slider"
              type="range"
              min="0"
              max="1"
              step="0.1"
            />
            <span>100%</span>
          </div>
        </details>
        <details>
          <summary>Reset options</summary>
          <button id="clear-photons">Clear light rays</button>
          <button id="clear-prisms">Clear prisms</button>
          <button id="reset">Reset simulation</button>
          <button id="show-welcome">Show welcome screen</button>
        </details>
      </div>
    </div>

    <!-- Welcome modal -->

    <div id="welcome" class="notice hidden">
      <h2>Let's make rainbows</h2>
      <div class="notice">
        <h3>Why?</h3>
        <p>The why</p>
      </div>

      <div class="notice">
        <h3>How?</h3>
        <ul>
          <li><b>Tap</b> to start/stop the simulation</li>
          <li><b>Drag</b> to make new light rays</li>
          <li><b>Hold</b> to create new prisms and more</li>
        </ul>
      </div>

      <div class="notice">
        <h3>ðŸŒˆ Templates</h3>
        <ul>
          <li><a href="/">Blank canvas</a> - you make the rules</li>
          <li>
            <a
              href="/?ref=0&prisms=351.00_515.00-40.00_514.00-197.00_246.00~703.12_674.98-471.99_285.46-924.89_280.06~1364.06_533.68-1037.51_539.85-1195.43_253.97&photons=p13.24_411.02d107.04_-33.83"
              >Classic prism</a
            >
            - the one you saw at school
          </li>
          <li>
            <a
              href="?ref=0.95&prisms=203.00_16.00-24.00_582.00-220.00_374.00-393.00_577.00~647.00_9.00-509.00_583.00-671.00_349.00-840.00_575.00~1097.00_8.00-957.00_583.00-1123.00_354.00-1288.00_581.00&photons=p180.19_21.71d-12.57_246.86"
              >Star trek prism</a
            >
            - because I love Star Trek
          </li>
          <li>
            <a
              href="?ref=0&prisms=382.00_174.00-345.00_296.00-478.00_219.00%7E630.00_221.00-601.00_325.00-718.00_288.00%7E429.00_389.00-406.00_474.00-550.00_440.00%7E201.00_750.00-260.00_561.00-316.00_727.00%7E395.00_603.00-484.00_681.00-539.00_564.00%7E144.00_81.00-174.00_129.00-205.00_67.00%7E523.00_106.00-557.00_163.00-603.00_88.00%7E762.00_78.00-791.00_136.00-801.00_53.00%7E697.00_563.00-697.00_423.00-788.00_457.00%7E549.00_715.00-637.00_758.00-640.00_709.00%7E68.00_477.00-72.00_646.00-183.00_481.00%7E759.00_249.00-862.00_158.00-858.00_333.00%7E56.00_244.00-7.00_320.00-84.00_409.00%7E262.00_205.00-330.00_184.00-304.00_261.00%7E727.00_580.00-627.00_659.00-730.00_745.00%7E714.00_201.00-775.00_175.00-733.00_242.00%7E202.00_762.00-132.00_698.00-157.00_790.00%7E656.00_433.00-555.00_475.00-657.00_593.00%7E59.00_134.00-127.00_114.00-124.00_201.00%7E198.00_134.00-243.00_179.00-184.00_207.00%7E258.00_397.00-101.00_395.00-181.00_260.00%7E279.00_287.00-345.00_337.00-256.00_508.00%7E341.00_544.00-283.00_536.00-319.00_491.00%7E460.00_268.00-460.00_381.00-547.00_293.00%7E549.00_181.00-550.00_263.00-585.00_215.00%7E599.00_382.00-731.00_311.00-842.00_409.00%7E944.00_98.00-926.00_183.00-988.00_183.00%7E1026.53_301.00-923.47_349.50-933.00_236.00%7E1002.40_419.14-923.60_495.36-897.00_389.00%7E995.00_361.00-1049.00_328.00-1059.00_367.00%7E806.00_445.00-876.34_436.12-847.66_554.88%7E850.00_584.00-994.00_551.00-869.00_657.00%7E761.00_637.00-828.00_636.00-812.00_762.00%7E1054.00_463.00-1054.00_634.00-1115.00_592.00%7E1026.00_231.00-1169.00_213.00-1075.00_270.00%7E1230.00_301.00-1167.00_469.00-1335.00_435.00%7E1083.85_317.22-1159.62_414.93-1144.53_311.85%7E953.00_650.00-965.00_762.00-1082.00_683.00%7E1331.00_481.00-1469.00_444.00-1342.00_597.00%7E1175.00_501.00-1311.00_583.00-1244.00_639.00%7E1147.00_635.00-1147.00_702.00-1270.00_662.00%7E1339.00_635.00-1336.00_755.00-1469.00_679.00%7E1288.00_248.00-1311.00_299.00-1310.00_250.00%7E1361.00_180.00-1356.00_389.00-1446.00_199.00%7E1236.00_156.00-1236.00_282.00-1295.00_152.00%7E1111.00_104.00-1104.00_190.00-1187.00_157.00"
              >Prism maze game</a
            >
            - make a light ray of at the top and try to get all the colours to
            the bottom.
          </li>
        </ul>

        <p>
          You can share what you make - just copy the URL. I can't wait to see
          what you come up with.
        </p>

        <p>
          P.S. You mobile will work fine with these templates, but there are
          more prisms to see on a lager screen.
        </p>
      </div>

      <button id="lets-go"><h4>Let's make rainbows!</h4></button>
    </div>
  </body>
</html>
